"0",""
"0","#Split Violin plotting credit to:"
"0","#https://stackoverflow.com/questions/35717353/split-violin-plot-with-ggplot2"
"0",""
"0","GeomSplitViolin <- ggproto(""GeomSplitViolin"", GeomViolin, "
"0","                           draw_group = function(self, data, ..., draw_quantiles = NULL) {"
"0","                             data <- transform(data, xminv = x - violinwidth * (x - xmin), xmaxv = x + violinwidth * (xmax - x))"
"0","                             grp <- data[1, ""group""]"
"0","                             newdata <- plyr::arrange(transform(data, x = if (grp %% 2 == 1) xminv else xmaxv), if (grp %% 2 == 1) y else -y)"
"0","                             newdata <- rbind(newdata[1, ], newdata, newdata[nrow(newdata), ], newdata[1, ])"
"0","                             newdata[c(1, nrow(newdata) - 1, nrow(newdata)), ""x""] <- round(newdata[1, ""x""])"
"0","                             "
"0","                             if (length(draw_quantiles) > 0 & !scales::zero_range(range(data$y))) {"
"0","                               stopifnot(all(draw_quantiles >= 0), all(draw_quantiles <="
"0","                                                                         1))"
"0","                               quantiles <- ggplot2:::create_quantile_segment_frame(data, draw_quantiles)"
"0","                               aesthetics <- data[rep(1, nrow(quantiles)), setdiff(names(data), c(""x"", ""y"")), drop = FALSE]"
"0","                               aesthetics$alpha <- rep(1, nrow(quantiles))"
"0","                               both <- cbind(quantiles, aesthetics)"
"0","                               quantile_grob <- GeomPath$draw_panel(both, ...)"
"0","                               ggplot2:::ggname(""geom_split_violin"", grid::grobTree(GeomPolygon$draw_panel(newdata, ...), quantile_grob))"
"0","                             }"
"0","                             else {"
"0","                               ggplot2:::ggname(""geom_split_violin"", GeomPolygon$draw_panel(newdata, ...))"
"0","                             }"
"0","                           })"
"0",""
"0","geom_split_violin <- function(mapping = NULL, data = NULL, stat = ""ydensity"", position = ""identity"", ..., "
"0","                              draw_quantiles = NULL, trim = TRUE, scale = ""area"", na.rm = FALSE, "
"0","                              show.legend = NA, inherit.aes = TRUE) {"
"0","  layer(data = data, mapping = mapping, stat = stat, geom = GeomSplitViolin, "
"0","        position = position, show.legend = show.legend, inherit.aes = inherit.aes, "
"0","        params = list(trim = trim, scale = scale, draw_quantiles = draw_quantiles, na.rm = na.rm, ...))"
"0","}"
"0",""
"0",""
"0",""
